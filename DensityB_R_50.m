function [Y,Xf,Af] = DensityB_R_50(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 16-Apr-2021 14:23:08.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx7 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2644.1;2622.1;2710;2631.8;2641.6;955.1;-22.3];
x1_step1.gain = [0.0137741046831956;0.0105042016806723;0.0204918032786885;0.0124069478908189;0.0127959053103007;0.0544959128065396;0.066006600660066];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.0040072543467940717823;0.0041355248983589061595;1.5707511321164773221;0.0015050702373430888212;0.0055795694271927962632;-0.0079898239910049483059;-0.0026820358628998710628;0.0091109436962634720442;-0.00090613307838889785035;0.0046549896742212864414;-0.00040976154247150382934;0.0055816058246946874399;0.0030254623815086823142;0.0046580180546477098491;-0.012699830691057841653;-3.6249796705540857644;-0.008482440413204679619;-3.00574526337423098;0.13966974180442692788;2.0016953900894480789;-0.0084510178142803565882;-0.010585620160632171205;-0.0091848785149659540467;0.00098308383388622053861;-0.0074137497195710224188;-0.0046194656845751653346;0.0029769534484630276287;0.0043929186070097540895;4.1893305717346445149;0.0067895752609225794999;-0.007362984949648410625;0.033265804350461898597;-0.00022553602253927944711;-0.011219132274238556926;-1.3764725962455592878;0.0047027882738103089083;0.00048820740291085533771;0.004176590673680543632;0.0014818293858508441597;-0.0068711229941592812803;-0.0053991086320061753775;0.0080001414035405001707;-1.1484548115105481791;0.34348454446334747425;-0.0058564907763991244649;3.7128079665641253726;0.0031954849615949678862;0.0075065418081546337464;-0.011862199892647258548;-0.0086727047541717647988];
IW1_1 = [0.02111562574478959009 -0.013762566967391679298 0.03513950715021130905 0.00096257342847322964908 0.018599972772946542915 0.0032790737727878670887 -0.034892563788109065559;0.040877982899655128379 -0.031599998616858894496 0.063550792985379328526 -0.01681079519436828873 0.02690528461601712773 0.012824656980086101069 -0.03928146634925941405;1.1243202341638016684 0.19321115021172532988 3.495414384147917275 -0.21420736528992301295 0.064849230382620665081 0.28083759144282149922 -0.77114381150820288102;0.034075017702159177135 -0.030489821629728387775 0.058895119789672961685 1.6243834639833694075e-05 0.02602213388213800091 -0.0016333443091689214821 -0.047693701674121166678;-0.024378454226946979361 0.016503667108133238117 -0.040479245499176155776 -0.00062964968842263620025 -0.021352762783960373139 -0.0026860418839437243295 0.040524635078533183252;0.035141919683775321714 -0.024780726246553985009 0.055852827019763032212 -0.0023722060724423632734 0.026975974679330244621 0.000107029831662954427 -0.052332939702975977969;0.0095041800235884238424 -0.0044402685407890990846 0.017747628116244775626 0.0010076649436837983344 0.011060933071399013661 0.0017279023087586318531 -0.018591176930336125034;-0.031162290675048914812 0.020737850435493476731 -0.04930791839821965783 0.00042880638690988900213 -0.025738510797368226168 -0.0012708656000444836474 0.050669132742240566292;0.0068525168939051819827 -0.0033051973013123532759 0.011000576023274852289 0.00072766980522952836186 0.0064218386548911257292 0.0020552191266258574252 -0.010808589791352050252;-0.026479145920956594779 0.019332196854269134006 -0.043685968266249833314 -0.00028382513244429075127 -0.021933145827708149661 -0.0028152767865578750585 0.041988979637743562012;0.006125237044907052425 -0.0030373701986549160418 0.0091050158030856406799 0.00074416866380036040315 0.0051425456146814863684 0.0021382508719287305655 -0.0086337030320613270679;-0.02506376217805515727 0.017251022237342629462 -0.041500434688863413468 -0.00051637252267709374005 -0.021683288221125099349 -0.0026753086918296594722 0.041274353726621776373;-0.01999747321571667541 0.012978385452868819103 -0.032828044707914935674 -0.0010551874025130966034 -0.01712846686001054039 -0.0037480906864099453046 0.032127642200815986762;-0.031501138410018475478 0.024726642657532937886 -0.051987420899813362174 0.00083939017285358254704 -0.025073269202287643692 -0.0013373779489799597717 0.047311883645835377254;0.036987569197335083693 -0.021486769841659130592 0.054192794359026068285 -0.0033167763953647201418 0.027112904942166556749 0.00125940129242922195 -0.057167290891787445051;-2.1625674996386932136 -3.2895859805748388638 0.27453177016825092149 0.74670617938560357452 -0.16679933847498629174 -0.19847961090562296627 0.57834869818474954339;0.033058333497581547655 -0.022896342975326285096 0.052433898243713597531 -0.0012692331649582281033 0.026328494812830720295 0.0008482279452590591861 -0.051537284793296146701;-0.2501519424453150231 0.3839737893344210562 -5.0768626132526994965 0.012563771701647089007 0.076375747972841398492 -0.14048026125664378472 0.63583030921399441571;0.076118817298402002836 0.12129097162275512267 0.13962747682442000485 -0.048790845054087574051 -0.1308781137612330947 -0.00083294136230130421186 0.020787756083474794033;0.44263985009436429552 -0.35359823845947518928 3.9513060828827808457 -0.13993924489629627761 0.078419683441864077023 0.20678389621059770076 -0.86180080578401774272;0.026514039579887817982 -0.016783412572238080862 0.043193397933894345231 0.0007502835017831983519 0.023825425541116485723 0.0017074912671500655243 -0.045840141975863557544;0.032832576015085920829 -0.02071803166233795318 0.050543995937618185765 -0.00077226611230472148005 0.026511580388190889024 0.0009441764985457937534 -0.053284512012470586217;0.024047133100646697623 -0.013694273625671849262 0.039758662722918933219 0.0018138194566731371746 0.023547167267258587581 0.0011062685078312038331 -0.04450208913450710152;-0.0085237867662337433311 0.0042814812004279920871 -0.01343674458143509845 -0.00089468327468594885821 -0.0076860902202137192443 -0.0026027762757460043766 0.013089291554594439243;-0.042178341806248312307 0.026149042453018828125 -0.060127375235304127143 0.023055887730810725039 -0.022066281726948650671 -0.026128742701891711359 0.034399468398898257193;0.020236233252607534888 -0.012612337043988610871 0.034178013558661103632 0.0010756024745919171362 0.018719488833876633815 0.0028916964822705455707 -0.034695215789644615056;-0.032928195852263975052 0.027190573736721328907 -0.05512208386960107398 0.0010727752081767555521 -0.025839457913300362124 -0.00033991072048513489446 0.047605865489516910327;0.038326497854166169388 -0.032204683093678417027 0.062805107441470747753 -0.011644400623184267274 0.02678295178190881129 0.0075874393557978396171 -0.040689229699462620138;0.05474876792971065248 -3.0762310128883285643 4.473009577811391857 -0.46207767221708850869 -1.1087147161282984165 -0.090891106493433543312 1.1940534569954039945;-0.026854258359710041909 0.018416389035930871149 -0.044075190622575893817 -0.00028750713577833095832 -0.023163671471209439784 -0.002234204459912657488 0.04438939157002963487;0.052547221838424230944 -0.028284322989037359586 0.068826144714121698098 -0.016276896012207536096 0.023165057211690317368 -0.00082681621456542908361 -0.049387149841938621231;-0.24945915451157804621 0.35351659379946126505 -0.40587288625166040301 -0.21090021802839473142 -0.26493307531732490645 0.11844646443620718279 -0.87425387778042706888;-0.034083109340956339872 0.030088006630587152412 -0.05861846545787960383 0.00060355873477522148547 -0.026504619944692314054 0.0014138452488528640422 0.047521246106925388308;0.036709391024747940746 -0.022777439955772887936 0.055317214395182688624 -0.003260523875904593194 0.027117979465289938912 0.0007939396003982100063 -0.055685669083401174995;-0.94609198957980400468 0.3688400015008140298 -1.1305735399765326488 -0.14111605649717740008 -0.38585916618724214189 0.0026849422145475438511 -1.0210694513214069179;-0.024146902542302683264 0.016706829995961344076 -0.04000637047867804108 -0.00063708842180737012932 -0.020677845244871800173 -0.0030027559272231929381 0.039332236537710403568;-0.00033497746889147602236 1.8913861276416173553e-05 -0.0013891959360956412928 6.4590716315560554308e-05 -0.0010364061977997927368 0.00020683376158182352803 0.0017128472593533005351;-0.023826253210513268638 0.016595779765644493725 -0.03939591474730781695 -0.00069336837796915031483 -0.020157619842578002045 -0.0032051823533394800669 0.038407022227130209469;-0.0059683430054613640856 0.002632786910815320975 -0.01086533010424574168 -0.00055253453871226092253 -0.006741493141005491449 -0.0013207477542185714313 0.01122116970088005844;0.029981237719680742942 -0.021587612667382821696 0.048726204943179654561 -0.00043409681998394139589 0.02469587744633546661 0.0017696805509260376838 -0.047564774045355931453;0.047024964784948400376 -0.031476484787495380424 0.075512589027527388108 -0.010803074330447548848 0.028144462687275464269 -0.0042224683982491307763 -0.052868157039675012232;-0.013238094022730269653 0.01817842775620581719 -0.048551106134921535873 -0.0049826298158896801735 -0.013445409634206073254 -0.012439358743980763466 0.036709510542530306154;-0.37649457214109077752 0.4662636887252646356 -1.1396944627707563669 -0.18209264085371398845 -0.25461553908804063218 0.08814387892440522787 -0.90928750829630011765;-0.31492226878298529291 0.12195386381193715208 -0.51211278455624575923 0.071146388031948934461 -0.12402768732492114312 -0.035356587952825549448 0.4019393088937416314;0.029370029554129428728 -0.02174144285086767811 0.048117928527300700414 -0.00033619179152781942382 0.024077088753633821977 0.0020497151152764421685 -0.046099039244013824412;1.9257729177585380942 2.7476529679442460719 -2.0115808279360236632 -0.54379611892479196023 0.75243229382701126706 0.25032119788189416409 0.43518320735620191764;-0.024558993410510321365 0.017804706304372530656 -0.04037076958677562194 -0.0007013182401912513653 -0.019933186740140496074 -0.003473735686252680914 0.038393845343402753512;-0.027729921047830719677 0.018800205454248548886 -0.045176978589347445425 -0.00020638039169918893901 -0.023866100017215705759 -0.0019848229638053070667 0.045987131345849710518;0.055582719509349225173 -0.022160657840324261836 0.071449569966979778468 -0.029823347298654698245 0.0085683585062555668588 0.022135444307178040596 -0.07212565509978223488;0.052212101620083155307 -0.030573513246304834245 0.076944631468518182027 -0.018154612965170995736 0.024942656070399572138 0.0041197651737376675407 -0.057029763205974276508];

% Layer 2
b2 = -0.099131317249822020754;
LW2_1 = [0.058805969399087713867 0.095262486043022800986 0.65725678615518301484 0.09092583944947532637 -0.06814804341924671216 0.092365816165753872324 0.029626187775387776563 -0.084776476598747138591 0.018360062132300562776 -0.072560696786597711494 0.015236659318118430523 -0.069752498669945872667 -0.054722334183022837417 -0.084779908702889386629 0.095110171963030121223 0.78320393597895565652 0.088509021008350827198 -1.8926419021068450199 0.17611960480963217979 -2.5216812857852550778 0.074783418872212126249 0.088167293629443366232 0.070163557680001348293 -0.022445034979584832513 -0.092529650378526784316 0.057529719942092771845 -0.087953899061842089058 0.09343622270982847311 -1.0016094205001371265 -0.074646779346796490739 0.10521221522155133066 0.053620448794695650674 -0.090857652811125483305 0.094788407346995701142 0.88879692190441716981 -0.066878816361711779237 -0.0022549000540837229635 -0.065642138628921348209 -0.018064138757220425668 0.081766412792518478048 0.11004879474914397441 -0.063237089208317678879 -0.96084789468156306391 0.32944513122652829828 0.080058405637345508854 0.70106153128482795456 -0.066696117050889694444 -0.076962435580166604909 0.12151763606198597023 0.11608399105149286301];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00671140939597315;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
